import{_ as T,r as h,I as A,y as V,K as E,k as F,a as S,o as r,c as p,b as i,z as b,m as w,f as K,g as O,q as _,x as U,L as J,p as H,i as P,M as R,E as W}from"./index-DuB4n2yr.js";import{a as m}from"./axios-B4uVmeYG.js";import{m as j}from"./index-BjJ2-QAr.js";import{L as G}from"./Loading2-BD2Qag2h.js";const c=f=>(H("data-v-b9f10cb5"),f=f(),P(),f),Q={class:"file-manager"},X={class:"add-style"},Y=c(()=>i("h2",null,"样式库",-1)),Z=c(()=>i("path",{d:"M925.696 384q19.456 0 37.376 7.68t30.72 20.48 20.48 30.72 7.68 37.376q0 20.48-7.68 37.888t-20.48 30.208-30.72 20.48-37.376 7.68l-287.744 0 0 287.744q0 20.48-7.68 37.888t-20.48 30.208-30.72 20.48-37.376 7.68q-20.48 0-37.888-7.68t-30.208-20.48-20.48-30.208-7.68-37.888l0-287.744-287.744 0q-20.48 0-37.888-7.68t-30.208-20.48-20.48-30.208-7.68-37.888q0-19.456 7.68-37.376t20.48-30.72 30.208-20.48 37.888-7.68l287.744 0 0-287.744q0-19.456 7.68-37.376t20.48-30.72 30.208-20.48 37.888-7.68q39.936 0 68.096 28.16t28.16 68.096l0 287.744 287.744 0z",fill:"#8a8a8a"},null,-1)),ee=[Z],te={class:"content"},le={class:"file-item"},oe={key:0},ne={key:2,class:"file-icon"},se=["onClick"],ae=c(()=>i("path",{d:"M880.288 232.48L560.192 45.12a95.648 95.648 0 0 0-96.64 0L143.68 232.48A96.64 96.64 0 0 0 96 315.904v397.664c0 34.784 18.624 66.88 48.736 84l320 181.92a95.52 95.52 0 0 0 94.496 0l320-181.92A96.576 96.576 0 0 0 928 713.568V315.904a96.64 96.64 0 0 0-47.712-83.424zM864 713.568c0 11.584-6.208 22.304-16.256 28l-320 181.92a31.776 31.776 0 0 1-31.488 0l-320-181.92A32.192 32.192 0 0 1 160 713.568V315.904c0-11.456 6.048-22.048 15.904-27.808l319.872-187.36a31.84 31.84 0 0 1 32.192 0l320.128 187.392c9.856 5.728 15.904 16.32 15.904 27.776v397.664z","p-id":"3149",fill:"#e6e6e6"},null,-1)),ie=c(()=>i("path",{d:"M512 320a192 192 0 1 0 0 384 192 192 0 0 0 0-384z m0 320a128 128 0 1 1 0-256 128 128 0 0 1 0 256z","p-id":"3150",fill:"#e6e6e6"},null,-1)),de=[ae,ie],re=["onClick"],ce=c(()=>i("path",{d:"M607.897867 768.043004c-17.717453 0-31.994625-14.277171-31.994625-31.994625L575.903242 383.935495c0-17.717453 14.277171-31.994625 31.994625-31.994625s31.994625 14.277171 31.994625 31.994625l0 351.94087C639.892491 753.593818 625.61532 768.043004 607.897867 768.043004z",fill:"#bfbfbf"},null,-1)),pe=c(()=>i("path",{d:"M415.930119 768.043004c-17.717453 0-31.994625-14.277171-31.994625-31.994625L383.935495 383.935495c0-17.717453 14.277171-31.994625 31.994625-31.994625 17.717453 0 31.994625 14.277171 31.994625 31.994625l0 351.94087C447.924744 753.593818 433.647573 768.043004 415.930119 768.043004z",fill:"#bfbfbf"},null,-1)),ue=c(()=>i("path",{d:"M928.016126 223.962372l-159.973123 0L768.043004 159.973123c0-52.980346-42.659499-95.983874-95.295817-95.983874L351.94087 63.989249c-52.980346 0-95.983874 43.003528-95.983874 95.983874l0 63.989249-159.973123 0c-17.717453 0-31.994625 14.277171-31.994625 31.994625s14.277171 31.994625 31.994625 31.994625l832.032253 0c17.717453 0 31.994625-14.277171 31.994625-31.994625S945.73358 223.962372 928.016126 223.962372zM319.946246 159.973123c0-17.545439 14.449185-31.994625 31.994625-31.994625l320.806316 0c17.545439 0 31.306568 14.105157 31.306568 31.994625l0 63.989249L319.946246 223.962372 319.946246 159.973123 319.946246 159.973123z",fill:"#bfbfbf"},null,-1)),he=c(()=>i("path",{d:"M736.048379 960.010751 288.123635 960.010751c-52.980346 0-95.983874-43.003528-95.983874-95.983874L192.139761 383.591466c0-17.717453 14.277171-31.994625 31.994625-31.994625s31.994625 14.277171 31.994625 31.994625l0 480.435411c0 17.717453 14.449185 31.994625 31.994625 31.994625l448.096758 0c17.717453 0 31.994625-14.277171 31.994625-31.994625L768.215018 384.795565c0-17.717453 14.277171-31.994625 31.994625-31.994625s31.994625 14.277171 31.994625 31.994625l0 479.231312C832.032253 916.835209 789.028725 960.010751 736.048379 960.010751z",fill:"#bfbfbf"},null,-1)),me=[ce,pe,ue,he],fe=["onClick"],ye=c(()=>i("path",{d:"M775.84 392.768l-155.2-172.352L160.768 643.264l-38.368 187.936 190.56-12.832zM929.952 229.952l-131.2-150.944-0.288-0.32a16 16 0 0 0-22.592-0.96l-131.168 120.576 155.168 172.352 128.832-118.464a15.936 15.936 0 0 0 1.248-22.24zM96 896h832v64H96z",fill:"#bfbfbf"},null,-1)),_e=[ye],ve={__name:"index",setup(f){const a=h([]),C=h(""),L={children:"children",label:"label"};A(),h(1);const y=h(null);h(null);const l=j(),v=h(!0),x=localStorage.getItem("username");l.setUsername(x);const k=(o,e)=>{const t={id:o,label:e};a.value.push(t),y.value=t.id,_(()=>{const n=document.querySelector(`[node-key="${t.id}"] input`);n&&n.focus()})},I=V(()=>a.value.length>1),D=()=>{let o=new FormData;o.append("username",l.username),m({method:"post",url:`${l.ipAddress}/api/createStyle`,data:o,headers:{"Content-Type":"multipart/form-data"}}).then(e=>{e.data.ret==0&&k(e.data.id,"未命名样式")})},M=o=>{R.confirm("确定删除此样式吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let e=new FormData;e.append("id",o.id),e.append("username",l.username),m({method:"post",url:`${l.ipAddress}/api/delStyle`,data:e,headers:{"Content-Type":"multipart/form-data"}}).then(n=>{});const t=a.value.findIndex(n=>n.id===o.id);t!==-1&&(a.value.splice(t,1),I.value||(l.openStyleID=null,l.usedStyleID=1,l.editorisShow=!1))})},z=o=>{y.value=o.id,_(()=>{const e=document.querySelector(`[node-key="${o.id}"] input`);e&&e.focus()})},g=o=>{y.value=null,o.label.trim()||(W.error("样式名不能为空"),o.label="未命名样式");let e=new FormData;e.append("id",o.id),e.append("styleName",o.label),e.append("username",l.username),m({method:"post",url:`${l.ipAddress}/api/renameStyle`,data:e,headers:{"Content-Type":"multipart/form-data"}}).then(t=>{})},N=(o,e,t)=>{const n=a.value.findIndex(s=>s.id===o.data.id),d=a.value.findIndex(s=>s.id===e.data.id);t==="before"?a.value.splice(d,0,...a.value.splice(n,1)):t==="after"&&a.value.splice(d+1,0,...a.value.splice(n,1))},B=o=>{l.setUsedStyleID(o.id);let e=new FormData;e.append("username",l.username),m({method:"post",url:`${l.ipAddress}/api/pullStyleList`,data:e,headers:{"Content-Type":"multipart/form-data"}}).then(t=>{let n=null;for(let d=0;d<t.data.styleList.length;d++)if(t.data.styleList[d][0]===l.usedStyleID){n=JSON.parse(t.data.styleList[d][2]);break}n?(l.setStyleConfig(n),l.applyStylesFromConfig()):console.error("No matching style configuration found")}).catch(t=>{console.error("Error fetching style list:",t)})},$=(o,e)=>{const t={id:o,label:e};a.value.push(t),_(()=>{const n=document.querySelector(`[node-key="${t.id}"] input`);n&&n.focus()})};E(()=>{let o=new FormData;o.append("username",l.username),m({method:"post",url:`${l.ipAddress}/api/pullStyleList`,data:o,headers:{"Content-Type":"multipart/form-data"}}).then(e=>{for(let t=0;t<e.data.styleList.length;t++)$(e.data.styleList[t][0],e.data.styleList[t][1])}).finally(()=>{v.value=!1})}),F(()=>{l.initializeTheme(),C.value=l.theme});function q(o){l.setOpenStyleID(o.id);let e=new FormData;e.append("username",l.username),m({method:"post",url:`${l.ipAddress}/api/pullStyleList`,data:e,headers:{"Content-Type":"multipart/form-data"}}).then(t=>{for(let n=0;n<t.data.styleList.length;n++)if(t.data.styleList[n][0]==l.openStyleID){const d=t.data.styleList[n][2];l.setStyleConfig(JSON.parse(d))}}),l.isShow=!1,l.setOpenNoteID(null),l.editorisShow=!0}return(o,e)=>{const t=S("el-input"),n=S("el-tree");return r(),p("div",Q,[i("div",X,[Y,(r(),p("svg",{class:"icon",viewBox:"0 0 1024 1024",width:"50",height:"50",onClick:D},ee))]),i("div",te,[v.value?(r(),b(G,{key:0})):w("",!0),K(n,{data:a.value,props:L,"highlight-current":!0,"node-key":"id",ref:"fileTree","empty-text":"",onNodeDrop:N,onNodeClick:B},{default:O(({node:d,data:s})=>[i("div",le,[y.value!==s.id?(r(),p("span",oe,U(s.label),1)):(r(),b(t,{key:1,modelValue:s.label,"onUpdate:modelValue":u=>s.label=u,size:"mini",maxlength:"20",onBlur:u=>g(s),onKeyup:J(u=>g(s),["enter","native"])},null,8,["modelValue","onUpdate:modelValue","onBlur","onKeyup"])),s.id>1?(r(),p("div",ne,[(r(),p("svg",{t:"1719995366880",onClick:u=>q(s),class:"editing",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3148",width:"200",height:"200"},de,8,se)),(r(),p("svg",{class:"delete",viewBox:"0 0 1024 1024",width:"20",height:"20",onClick:u=>M(s)},me,8,re)),(r(),p("svg",{class:"rename",viewBox:"0 0 1024 1024",width:"20",height:"20",onClick:u=>z(s)},_e,8,fe))])):w("",!0)])]),_:1},8,["data"])])])}}},Ce=T(ve,[["__scopeId","data-v-b9f10cb5"]]);export{Ce as default};
