import{_ as q,r as p,I as z,y as T,K as E,k as V,a as b,o as c,c as h,b as i,z as w,m as A,f as K,g as H,q as v,x as R,L as U,p as O,i as J,M as P,E as W}from"./index-DuB4n2yr.js";import{a as m}from"./axios-B4uVmeYG.js";import{m as j}from"./index-BjJ2-QAr.js";import{L as G}from"./Loading2-BD2Qag2h.js";const u=f=>(O("data-v-25a071c0"),f=f(),J(),f),Q={class:"file-manager"},X={class:"add-file"},Y=u(()=>i("h2",null,"文档目录",-1)),Z=u(()=>i("path",{d:"M925.696 384q19.456 0 37.376 7.68t30.72 20.48 20.48 30.72 7.68 37.376q0 20.48-7.68 37.888t-20.48 30.208-30.72 20.48-37.376 7.68l-287.744 0 0 287.744q0 20.48-7.68 37.888t-20.48 30.208-30.72 20.48-37.376 7.68q-20.48 0-37.888-7.68t-30.208-20.48-20.48-30.208-7.68-37.888l0-287.744-287.744 0q-20.48 0-37.888-7.68t-30.208-20.48-20.48-30.208-7.68-37.888q0-19.456 7.68-37.376t20.48-30.72 30.208-20.48 37.888-7.68l287.744 0 0-287.744q0-19.456 7.68-37.376t20.48-30.72 30.208-20.48 37.888-7.68q39.936 0 68.096 28.16t28.16 68.096l0 287.744 287.744 0z",fill:"#8a8a8a"},null,-1)),ee=[Z],te={class:"content"},oe={class:"file-item"},ae={key:0},ne={class:"file-icon"},se=["onClick"],le=u(()=>i("path",{d:"M607.897867 768.043004c-17.717453 0-31.994625-14.277171-31.994625-31.994625L575.903242 383.935495c0-17.717453 14.277171-31.994625 31.994625-31.994625s31.994625 14.277171 31.994625 31.994625l0 351.94087C639.892491 753.593818 625.61532 768.043004 607.897867 768.043004z",fill:"#bfbfbf"},null,-1)),ie=u(()=>i("path",{d:"M415.930119 768.043004c-17.717453 0-31.994625-14.277171-31.994625-31.994625L383.935495 383.935495c0-17.717453 14.277171-31.994625 31.994625-31.994625 17.717453 0 31.994625 14.277171 31.994625 31.994625l0 351.94087C447.924744 753.593818 433.647573 768.043004 415.930119 768.043004z",fill:"#bfbfbf"},null,-1)),de=u(()=>i("path",{d:"M928.016126 223.962372l-159.973123 0L768.043004 159.973123c0-52.980346-42.659499-95.983874-95.295817-95.983874L351.94087 63.989249c-52.980346 0-95.983874 43.003528-95.983874 95.983874l0 63.989249-159.973123 0c-17.717453 0-31.994625 14.277171-31.994625 31.994625s14.277171 31.994625 31.994625 31.994625l832.032253 0c17.717453 0 31.994625-14.277171 31.994625-31.994625S945.73358 223.962372 928.016126 223.962372zM319.946246 159.973123c0-17.545439 14.449185-31.994625 31.994625-31.994625l320.806316 0c17.545439 0 31.306568 14.105157 31.306568 31.994625l0 63.989249L319.946246 223.962372 319.946246 159.973123 319.946246 159.973123z",fill:"#bfbfbf"},null,-1)),re=u(()=>i("path",{d:"M736.048379 960.010751 288.123635 960.010751c-52.980346 0-95.983874-43.003528-95.983874-95.983874L192.139761 383.591466c0-17.717453 14.277171-31.994625 31.994625-31.994625s31.994625 14.277171 31.994625 31.994625l0 480.435411c0 17.717453 14.449185 31.994625 31.994625 31.994625l448.096758 0c17.717453 0 31.994625-14.277171 31.994625-31.994625L768.215018 384.795565c0-17.717453 14.277171-31.994625 31.994625-31.994625s31.994625 14.277171 31.994625 31.994625l0 479.231312C832.032253 916.835209 789.028725 960.010751 736.048379 960.010751z",fill:"#bfbfbf"},null,-1)),ce=[le,ie,de,re],ue=["onClick"],pe=u(()=>i("path",{d:"M775.84 392.768l-155.2-172.352L160.768 643.264l-38.368 187.936 190.56-12.832zM929.952 229.952l-131.2-150.944-0.288-0.32a16 16 0 0 0-22.592-0.96l-131.168 120.576 155.168 172.352 128.832-118.464a15.936 15.936 0 0 0 1.248-22.24zM96 896h832v64H96z",fill:"#bfbfbf"},null,-1)),me=[pe],he={__name:"index",setup(f){const l=p([]),C=p(""),L={children:"children",label:"label"};z(),p(1);const _=p(null);p(null);const t=j(),y=p(!0),x=localStorage.getItem("username");t.setUsername(x);const S=(a,e)=>{const o={id:a,label:e};l.value.push(o),_.value=o.id,v(()=>{const s=document.querySelector(`[node-key="${o.id}"] input`);s&&s.focus()})},k=()=>{t.editorisShow=!1;let a=new FormData;a.append("username",t.username),m({method:"post",url:`${t.ipAddress}/api/createNote`,data:a,headers:{"Content-Type":"multipart/form-data"}}).then(e=>{e.data.ret==0?S(e.data.id,"未命名页面"):alert(e.data.msg)})},N=T(()=>l.value.length>0),D=a=>{t.editorisShow=!1,P.confirm("确定删除此页面吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let e=new FormData;e.append("id",a.id),e.append("username",t.username),m({method:"post",url:`${t.ipAddress}/api/delNote`,data:e,headers:{"Content-Type":"multipart/form-data"}}).then(s=>{});const o=l.value.findIndex(s=>s.id===a.id);o!==-1&&(l.value.splice(o,1),N.value||(t.openNoteID=null,t.isShow=!1))})},I=a=>{t.editorisShow=!1,_.value=a.id,v(()=>{const e=document.querySelector(`[node-key="${a.id}"] input`);e&&e.focus()})},g=a=>{_.value=null,a.label.trim()||(W.error("页面名不能为空"),a.label="未命名页面");let e=new FormData;e.append("id",a.id),e.append("noteName",a.label),e.append("username",t.username),m({method:"post",url:`${t.ipAddress}/api/renameNote`,data:e,headers:{"Content-Type":"multipart/form-data"}}).then(o=>{})},M=(a,e,o)=>{const s=l.value.findIndex(n=>n.id===a.data.id),r=l.value.findIndex(n=>n.id===e.data.id);o==="before"?l.value.splice(r,0,...l.value.splice(s,1)):o==="after"&&l.value.splice(r+1,0,...l.value.splice(s,1))},F=async a=>{t.editorisShow=!1,t.setOpenNoteID(a.id);try{let e=new FormData;e.append("username",t.username);const o=await m({method:"post",url:`${t.ipAddress}/api/pullNoteList`,data:e,headers:{"Content-Type":"multipart/form-data"}});for(let n=0;n<o.data.noteList.length;n++)if(o.data.noteList[n][0]==t.openNoteID){const d=o.data.noteList[n][2];t.setHTMLContent(null),v(()=>{t.setHTMLContent(d)}),t.usedStyleID=o.data.noteList[n][3];break}let s=new FormData;s.append("username",t.username);const r=await m({method:"post",url:`${t.ipAddress}/api/pullStyleList`,data:s,headers:{"Content-Type":"multipart/form-data"}});for(let n=0;n<r.data.styleList.length;n++)if(r.data.styleList[n][0]==t.usedStyleID){const d=r.data.styleList[n][2];t.setStyleConfig(JSON.parse(d));break}}catch(e){console.error("Error fetching data:",e)}},B=(a,e)=>{const o={id:a,label:e};l.value.push(o),v(()=>{const s=document.querySelector(`[node-key="${o.id}"] input`);s&&s.focus()})};E(()=>{let a=new FormData;a.append("username",t.username),m({method:"post",url:`${t.ipAddress}/api/pullNoteList`,data:a,headers:{"Content-Type":"multipart/form-data"}}).then(e=>{for(let o=0;o<e.data.noteList.length;o++)B(e.data.noteList[o][0],e.data.noteList[o][1])}).finally(()=>{y.value=!1})}),V(()=>{t.initializeTheme(),C.value=t.theme});function $(){t.isShow=!0}return(a,e)=>{const o=b("el-input"),s=b("el-tree");return c(),h("div",Q,[i("div",X,[Y,(c(),h("svg",{class:"icon",viewBox:"0 0 1024 1024",width:"50",height:"50",onClick:k},ee))]),i("div",te,[y.value?(c(),w(G,{key:0})):A("",!0),K(s,{data:l.value,props:L,"highlight-current":!0,"node-key":"id",ref:"fileTree","empty-text":"",onNodeDrop:M,onCurrentChange:$,onNodeClick:F},{default:H(({node:r,data:n})=>[i("div",oe,[_.value!==n.id?(c(),h("span",ae,R(n.label),1)):(c(),w(o,{key:1,modelValue:n.label,"onUpdate:modelValue":d=>n.label=d,size:"mini",maxlength:"20",onBlur:d=>g(n),onKeyup:U(d=>g(n),["enter","native"])},null,8,["modelValue","onUpdate:modelValue","onBlur","onKeyup"])),i("div",ne,[(c(),h("svg",{class:"delete",viewBox:"0 0 1024 1024",width:"20",height:"20",onClick:d=>D(n)},ce,8,se)),(c(),h("svg",{class:"rename",viewBox:"0 0 1024 1024",width:"20",height:"20",onClick:d=>I(n)},me,8,ue))])])]),_:1},8,["data"])])])}}},ge=q(he,[["__scopeId","data-v-25a071c0"]]);export{ge as default};
